<?php

namespace App\Services\NajmHoda\Agents;

use App\Services\NajmHoda\BaseAgent;

/**
 * Ø¹Ø§Ù…Ù„ Ø±Ø§Ù‡Ù†Ù…Ø§ Ù†Ø¬Ù…â€ŒÙ‡Ø¯Ø§
 * 
 * Ù…Ø³Ø¦ÙˆÙ„ÛŒØªâ€ŒÙ‡Ø§:
 * - ØªØ¹ÛŒÛŒÙ† Ù…Ø³ÛŒØ± Ùˆ Ù‡Ø¯Ø§ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡
 * - Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù‚Ø´Ù‡ Ø±Ø§Ù‡
 * - ØªØ¹ÛŒÛŒÙ† Ø§Ù‡Ø¯Ø§Ù SMART
 * - ØªØµÙ…ÛŒÙ…â€ŒÚ¯ÛŒØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒÚ©
 * - Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ø±ÛŒØ³Ú©
 * - Ø§ÙˆÙ„ÙˆÛŒØªâ€ŒØ¨Ù†Ø¯ÛŒ Ø§Ø¨ØªÚ©Ø§Ø±Ø§Øª
 */
class GuideAgent extends BaseAgent
{
    protected string $role = 'guide';
    
    protected array $expertise = [
        'strategic_planning',
        'roadmap_creation',
        'goal_setting',
        'vision_alignment',
        'decision_making',
        'risk_assessment',
        'prioritization',
    ];
    
    public function getSystemPrompt(): string
    {
        return "Ø´Ù…Ø§ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒÚ© Ù¾Ø±ÙˆÚ˜Ù‡ NewEarthCoop Ù‡Ø³ØªÛŒØ¯ Ùˆ Ø¨Ø®Ø´ÛŒ Ø§Ø² Ø³ÛŒØ³ØªÙ… Ù†Ø¬Ù…â€ŒÙ‡Ø¯Ø§.

**Ù†Ø§Ù… Ø´Ù…Ø§:** Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ù†Ø¬Ù…â€ŒÙ‡Ø¯Ø§ ğŸ“–

**Ù…Ø§Ù…ÙˆØ±ÛŒØª:**
ØªØ¹ÛŒÛŒÙ† Ù…Ø³ÛŒØ± Ùˆ Ù‡Ø¯Ø§ÛŒØª Ù¾Ø±ÙˆÚ˜Ù‡ Ø§Ø±Ø«Ú©ÙˆÙ¾ Ø¨Ù‡ Ø³Ù…Øª Ú†Ø´Ù…â€ŒØ§Ù†Ø¯Ø§Ø² ØªØ¹ÛŒÛŒÙ† Ø´Ø¯Ù‡

**Ú†Ø´Ù…â€ŒØ§Ù†Ø¯Ø§Ø² Ù¾Ø±ÙˆÚ˜Ù‡ Ø§Ø±Ø«Ú©ÙˆÙ¾:**
Ø¯Ù†ÛŒØ§ÛŒÛŒ Ú©Ù‡ Ø¯Ø± Ø¢Ù†:
- Ù‡Ù…Ù‡ Ø§ÙØ±Ø§Ø¯ ÙØ±ØµØª Ø¨Ø±Ø§Ø¨Ø± Ø¨Ø±Ø§ÛŒ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø±Ù†Ø¯
- Ø«Ø±ÙˆØª Ø¨Ù‡ ØµÙˆØ±Øª Ø¹Ø§Ø¯Ù„Ø§Ù†Ù‡ ØªÙˆØ²ÛŒØ¹ Ù…ÛŒâ€ŒØ´ÙˆØ¯
- ØªØµÙ…ÛŒÙ…Ø§Øª Ø¨Ù‡ ØµÙˆØ±Øª Ø¬Ù…Ø¹ÛŒ Ùˆ Ø¯Ù…ÙˆÚ©Ø±Ø§ØªÛŒÚ© Ú¯Ø±ÙØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
- Ø´ÙØ§ÙÛŒØª Ú©Ø§Ù…Ù„ Ø¯Ø± ØªÙ…Ø§Ù… ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯
- Ù…Ø­ÛŒØ· Ø²ÛŒØ³Øª Ùˆ ØªÙˆØ³Ø¹Ù‡ Ù¾Ø§ÛŒØ¯Ø§Ø± Ù…Ø­Ø§ÙØ¸Øª Ù…ÛŒâ€ŒØ´ÙˆØ¯

**Ø§Ø±Ø²Ø´â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ:**
1. **Ø´ÙØ§ÙÛŒØª**: Ù‡Ù…Ù‡ Ú†ÛŒØ² Ù‚Ø§Ø¨Ù„ Ø±Ø¤ÛŒØª Ùˆ ØªØ£ÛŒÛŒØ¯ Ø§Ø³Øª
2. **Ø¹Ø¯Ø§Ù„Øª**: ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ø±Ø§Ø¨Ø± Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ Ø§Ø¹Ø¶Ø§
3. **Ù…Ø´Ø§Ø±Ú©Øª**: ØªØµÙ…ÛŒÙ…â€ŒÚ¯ÛŒØ±ÛŒ Ø¬Ù…Ø¹ÛŒ Ùˆ Ø¯Ù…ÙˆÚ©Ø±Ø§ØªÛŒÚ©
4. **Ù†ÙˆØ¢ÙˆØ±ÛŒ**: Ù¾Ø°ÛŒØ±Ø´ ØªØºÛŒÛŒØ± Ùˆ Ø¨Ù‡Ø¨ÙˆØ¯ Ù…Ø³ØªÙ…Ø±
5. **Ù¾Ø§ÛŒØ¯Ø§Ø±ÛŒ**: ÙÚ©Ø± Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ø¢ÛŒÙ†Ø¯Ù‡ Ùˆ Ù†Ø³Ù„â€ŒÙ‡Ø§ÛŒ Ø¨Ø¹Ø¯

**Ù…Ø³Ø¦ÙˆÙ„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§:**
1. Ø­ÙØ¸ Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ ØªØµÙ…ÛŒÙ…Ø§Øª Ø¨Ø§ Ú†Ø´Ù…â€ŒØ§Ù†Ø¯Ø§Ø² Ùˆ Ø§Ø±Ø²Ø´â€ŒÙ‡Ø§
2. Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù‚Ø´Ù‡ Ø±Ø§Ù‡ (Roadmap) ÙˆØ§Ù‚Ø¹â€ŒØ¨ÛŒÙ†Ø§Ù†Ù‡
3. ØªØ¹ÛŒÛŒÙ† Ø§Ù‡Ø¯Ø§Ù SMART
4. ØªØµÙ…ÛŒÙ…â€ŒÚ¯ÛŒØ±ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒÚ© Ø¨Ù„Ù†Ø¯Ù…Ø¯Øª
5. Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ø±ÛŒØ³Ú©â€ŒÙ‡Ø§
6. Ø§ÙˆÙ„ÙˆÛŒØªâ€ŒØ¨Ù†Ø¯ÛŒ Ø§Ø¨ØªÚ©Ø§Ø±Ø§Øª Ùˆ Ù¾Ø±ÙˆÚ˜Ù‡â€ŒÙ‡Ø§
7. Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ù¾ÛŒØ´Ø±ÙØª Ùˆ ØªØ·Ø¨ÛŒÙ‚ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ

**Ù†Ø­ÙˆÙ‡ Ú©Ø§Ø± Ø´Ù…Ø§:**
- Ù‡Ù…ÛŒØ´Ù‡ Ø¨Ø§ Ú†Ø´Ù…â€ŒØ§Ù†Ø¯Ø§Ø² Ùˆ Ø§Ø±Ø²Ø´â€ŒÙ‡Ø§ Ù‡Ù…Ø§Ù‡Ù†Ú¯ Ø¨Ø§Ø´ÛŒØ¯
- ØªØµÙ…ÛŒÙ…Ø§Øª Ø±Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¯Ø§Ø¯Ù‡ Ùˆ ØªØ­Ù„ÛŒÙ„ Ø¨Ú¯ÛŒØ±ÛŒØ¯
- Ø¨Ù„Ù†Ø¯Ù…Ø¯Øª ÙÚ©Ø± Ú©Ù†ÛŒØ¯ØŒ Ø§Ù…Ø§ Ú©ÙˆØªØ§Ù‡â€ŒÙ…Ø¯Øª Ø¹Ù…Ù„ Ú©Ù†ÛŒØ¯
- Ø±ÛŒØ³Ú©â€ŒÙ‡Ø§ Ø±Ø§ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ùˆ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†ÛŒØ¯
- Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ± Ø¨Ø§Ø´ÛŒØ¯ØŒ Ø§Ù…Ø§ Ø¯Ø± Ø§ØµÙˆÙ„ Ù…Ø­Ú©Ù…
- Ù‡Ù…ÛŒØ´Ù‡ Ø¨Ù‡ Ù…Ù†Ø§ÙØ¹ Ø¬Ø§Ù…Ø¹Ù‡ ÙÚ©Ø± Ú©Ù†ÛŒØ¯

**Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ø´Ù…Ø§:**
- SWOT Analysis
- OKR (Objectives and Key Results)
- SMART Goals
- Risk Matrix
- Value Proposition Canvas
- Business Model Canvas

**Ù…Ø«Ø§Ù„ Ù†Ù‚Ø´Ù‡ Ø±Ø§Ù‡ Ø´Ù…Ø§:**
```markdown
# Ù†Ù‚Ø´Ù‡ Ø±Ø§Ù‡ Ø§Ø±Ø«Ú©ÙˆÙ¾ - Q1 2026

## Ú†Ø´Ù…â€ŒØ§Ù†Ø¯Ø§Ø²
Ù¾Ù„ØªÙØ±Ù… Ø§Ù‚ØªØµØ§Ø¯ ØªØ¹Ø§ÙˆÙ†ÛŒ Ø´Ù…Ø§Ø±Ù‡ 1 Ø§ÛŒØ±Ø§Ù† Ø¨Ø§ 10,000 Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ø§Ù„

## Ø§Ù‡Ø¯Ø§Ù Ú©Ù„ÛŒØ¯ÛŒ (OKRs)

### Objective 1: Ø§ÙØ²Ø§ÛŒØ´ Ù¾Ø°ÛŒØ±Ø´ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†
- KR1: 1000 Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù… Ú©Ù†Ù†Ø¯
- KR2: 60% Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ù‡ÙØªÚ¯ÛŒ ÙØ¹Ø§Ù„ Ø¨Ø§Ø´Ù†Ø¯
- KR3: NPS Score Ø¨Ø§Ù„Ø§ÛŒ 50

### Objective 2: Ø¨Ù‡Ø¨ÙˆØ¯ Ù¾Ù„ØªÙØ±Ù…
- KR1: Ø²Ù…Ø§Ù† Ù¾Ø§Ø³Ø® < 200ms
- KR2: Uptime > 99.5%
- KR3: Zero critical bugs

## Milestones

### Ù…Ø§Ù‡ 1 (ÙÙˆØ±ÛŒÙ‡)
- [ ] ØªÚ©Ù…ÛŒÙ„ Ø³ÛŒØ³ØªÙ… Ø­Ø±Ø§Ø¬
- [ ] Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ v1
- [ ] Ù„Ø§Ù†Ú† Ú©Ù…Ù¾ÛŒÙ† Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ

### Ù…Ø§Ù‡ 2 (Ù…Ø§Ø±Ø³)
- [ ] Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ù…ÙˆØ¨Ø§ÛŒÙ„ (Beta)
- [ ] Ø³ÛŒØ³ØªÙ… Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†
- [ ] 500 Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ø§Ù„

### Ù…Ø§Ù‡ 3 (Ø¢ÙˆØ±ÛŒÙ„)
- [ ] Ø³ÛŒØ³ØªÙ… Ù¾Ø±Ø¯Ø§Ø®Øª Ø¢Ù†Ù„Ø§ÛŒÙ†
- [ ] Dashboard ØªØ­Ù„ÛŒÙ„ÛŒ
- [ ] 1000 Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ø§Ù„

## Ø±ÛŒØ³Ú©â€ŒÙ‡Ø§
1. Ú©Ù…Ø¨ÙˆØ¯ Ù…Ù†Ø§Ø¨Ø¹ Ù…Ø§Ù„ÛŒ â†’ Ø¬Ø°Ø¨ Ø³Ø±Ù…Ø§ÛŒÙ‡
2. Ø±Ù‚Ø§Ø¨Øª Ø´Ø¯ÛŒØ¯ â†’ ØªÙ…Ø§ÛŒØ² ÙˆØ§Ø¶Ø­
3. Ù…Ø´Ú©Ù„Ø§Øª Ù‚Ø§Ù†ÙˆÙ†ÛŒ â†’ Ù…Ø´Ø§ÙˆØ±Ù‡ Ø­Ù‚ÙˆÙ‚ÛŒ

## Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ù…ÙˆÙÙ‚ÛŒØª
- MAU (Monthly Active Users): 1000+
- Transaction Volume: $10,000+
- User Satisfaction: 80%+
```

Ù‡Ù…ÛŒØ´Ù‡ Ø¨Ù‡ Ø²Ø¨Ø§Ù† ÙØ§Ø±Ø³ÛŒ Ùˆ Ø¨Ø§ Ø¯ÛŒØ¯ÛŒ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒÚ© Ù¾Ø§Ø³Ø® Ø¯Ù‡ÛŒØ¯.";
    }
    
    /**
     * Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù‚Ø´Ù‡ Ø±Ø§Ù‡
     */
    public function createRoadmap(string $timeframe, string $objectives): array
    {
        $currentState = $this->getCurrentState();
        
        $prompt = "ÛŒÚ© Ù†Ù‚Ø´Ù‡ Ø±Ø§Ù‡ {$timeframe} Ø¨Ø±Ø§ÛŒ Ø§Ù‡Ø¯Ø§Ù Ø²ÛŒØ± Ø¨Ø³Ø§Ø²:

**Ø§Ù‡Ø¯Ø§Ù:**
{$objectives}

**ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡:**
{$currentState}

Ù†Ù‚Ø´Ù‡ Ø±Ø§Ù‡ Ø¨Ø§ÛŒØ¯ Ø´Ø§Ù…Ù„:

1. **Ø®Ù„Ø§ØµÙ‡ Ø§Ø¬Ø±Ø§ÛŒÛŒ:**
   - Ú†Ø´Ù…â€ŒØ§Ù†Ø¯Ø§Ø²
   - Ø§Ù‡Ø¯Ø§Ù Ú©Ù„ÛŒØ¯ÛŒ

2. **OKRs (Objectives & Key Results):**
   - Ø­Ø¯Ø§Ù‚Ù„ 3 Objective
   - Ù‡Ø± Objective Ø¨Ø§ 3-5 Key Result

3. **Milestones Ùˆ Timeline:**
   - Ù†Ù‚Ø§Ø· Ú©Ù„ÛŒØ¯ÛŒ
   - ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ù…
   - Deliverables

4. **Ù…Ù†Ø§Ø¨Ø¹ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²:**
   - Ù…Ù†Ø§Ø¨Ø¹ Ø§Ù†Ø³Ø§Ù†ÛŒ
   - Ù…Ù†Ø§Ø¨Ø¹ Ù…Ø§Ù„ÛŒ
   - Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ Ùˆ ØªÚ©Ù†ÙˆÙ„ÙˆÚ˜ÛŒ

5. **Ø±ÛŒØ³Ú©â€ŒÙ‡Ø§ Ùˆ Ú©Ø§Ù‡Ø´â€ŒØ¯Ù‡Ù†Ø¯Ù‡â€ŒÙ‡Ø§:**
   - Ø±ÛŒØ³Ú©â€ŒÙ‡Ø§ÛŒ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø´Ø¯Ù‡
   - Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ Ú©Ø§Ù‡Ø´ Ù‡Ø± Ø±ÛŒØ³Ú©

6. **Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ù…ÙˆÙÙ‚ÛŒØª:**
   - KPIs Ø§ØµÙ„ÛŒ
   - Ú†Ø·ÙˆØ± Ù…ÙˆÙÙ‚ÛŒØª Ø±Ø§ Ø§Ù†Ø¯Ø§Ø²Ù‡ Ù…ÛŒâ€ŒÚ¯ÛŒØ±ÛŒÙ…

7. **ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒâ€ŒÙ‡Ø§:**
   - ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ÛŒ
   - ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø®Ø§Ø±Ø¬ÛŒ

8. **ÙØ§Ø²Ø¨Ù†Ø¯ÛŒ (Phases):**
   - ØªÙ‚Ø³ÛŒÙ… Ø¨Ù‡ ÙØ§Ø²Ù‡Ø§ÛŒ Ù…Ù†Ø·Ù‚ÛŒ
   - Ø§Ù‡Ø¯Ø§Ù Ù‡Ø± ÙØ§Ø²

ÙØ±Ù…Øª: Markdown Ø¨Ø§ Ø³Ø§Ø®ØªØ§Ø± ÙˆØ§Ø¶Ø­";

        $response = $this->ask($prompt);
        
        return [
            'roadmap' => $response,
            'format' => 'markdown',
            'timeframe' => $timeframe,
        ];
    }
    
    /**
     * ØªØµÙ…ÛŒÙ…â€ŒÚ¯ÛŒØ±ÛŒ Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒÚ©
     */
    public function makeDecision(string $situation, array $options): array
    {
        $optionsText = '';
        foreach ($options as $index => $option) {
            $optionsText .= "\n**Ú¯Ø²ÛŒÙ†Ù‡ " . ($index + 1) . ":** " . (is_array($option) ? json_encode($option, JSON_UNESCAPED_UNICODE) : $option);
        }
        
        $prompt = "ØªØµÙ…ÛŒÙ… Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒÚ© Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² Ø§Ø³Øª:

**Ù…ÙˆÙ‚Ø¹ÛŒØª:**
{$situation}

**Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯:**
{$optionsText}

**Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ ØªØµÙ…ÛŒÙ…â€ŒÚ¯ÛŒØ±ÛŒ:**
1. Ù‡Ù…Ø§Ù‡Ù†Ú¯ÛŒ Ø¨Ø§ Ú†Ø´Ù…â€ŒØ§Ù†Ø¯Ø§Ø² Ùˆ Ø§Ø±Ø²Ø´â€ŒÙ‡Ø§
2. ØªØ£Ø«ÛŒØ± Ø¨Ø± Ú©Ø§Ø±Ø¨Ø±Ø§Ù† (Ú©ÙˆØªØ§Ù‡ Ùˆ Ø¨Ù„Ù†Ø¯Ù…Ø¯Øª)
3. Ù‡Ø²ÛŒÙ†Ù‡ vs Ø§Ø±Ø²Ø´ (ROI)
4. Ø²Ù…Ø§Ù† Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ
5. Ø±ÛŒØ³Ú© Ùˆ Ø¹Ø¯Ù… Ù‚Ø·Ø¹ÛŒØª
6. Ù…Ù‚ÛŒØ§Ø³â€ŒÙ¾Ø°ÛŒØ±ÛŒ
7. Ø±Ù‚Ø§Ø¨ØªÛŒ Ø¨ÙˆØ¯Ù†
8. ØªÙˆØ³Ø¹Ù‡â€ŒÙ¾Ø°ÛŒØ±ÛŒ Ø¢ÛŒÙ†Ø¯Ù‡

Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ú¯Ø²ÛŒÙ†Ù‡ ØªØ­Ù„ÛŒÙ„ Ú©Ù†:

1. **Ù†Ù‚Ø§Ø· Ù‚ÙˆØª:**
2. **Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù:**
3. **ÙØ±ØµØªâ€ŒÙ‡Ø§:**
4. **ØªÙ‡Ø¯ÛŒØ¯Ù‡Ø§:**
5. **Ø§Ù…ØªÛŒØ§Ø² Ú©Ù„ÛŒ (1-10):**

Ø³Ù¾Ø³:

**ØªÙˆØµÛŒÙ‡ Ù†Ù‡Ø§ÛŒÛŒ:**
- Ú©Ø¯Ø§Ù… Ú¯Ø²ÛŒÙ†Ù‡ (ÛŒØ§ ØªØ±Ú©ÛŒØ¨ÛŒ)
- Ú†Ø±Ø§ØŸ
- Ú†Ø·ÙˆØ±ØŸ

**Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø§Ø¬Ø±Ø§:**
- Ù…Ø±Ø§Ø­Ù„ Ú©Ù„ÛŒØ¯ÛŒ
- Timeline
- Ù…Ù†Ø§Ø¨Ø¹ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²

**Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ:**
- Ú†Ø·ÙˆØ± Ù…ÙˆÙÙ‚ÛŒØª Ø±Ø§ Ù…ÛŒâ€ŒØ³Ù†Ø¬ÛŒÙ…ØŸ

ÙØ±Ù…Øª: JSON";

        $response = $this->ask($prompt);
        
        return $this->parseJsonResponse($response);
    }
    
    /**
     * Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ù¾ÛŒØ´Ø±ÙØª
     */
    public function assessProgress(): array
    {
        $currentState = $this->getCurrentState();
        $roadmap = $this->getCurrentRoadmap();
        $kpis = $this->getKPIs();
        
        $prompt = "Ù¾ÛŒØ´Ø±ÙØª Ù¾Ø±ÙˆÚ˜Ù‡ Ø±Ø§ Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ Ú©Ù†:

**ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ:**
{$currentState}

**Ù†Ù‚Ø´Ù‡ Ø±Ø§Ù‡:**
{$roadmap}

**KPIs:**
{$kpis}

Ú¯Ø²Ø§Ø±Ø´ Ù¾ÛŒØ´Ø±ÙØª Ø´Ø§Ù…Ù„:

1. **Ø®Ù„Ø§ØµÙ‡ Ø§Ø¬Ø±Ø§ÛŒÛŒ:**
   - ÙˆØ¶Ø¹ÛŒØª Ú©Ù„ÛŒ (On Track / At Risk / Off Track)
   - Ø¯Ø±ØµØ¯ Ù¾ÛŒØ´Ø±ÙØª Ú©Ù„ÛŒ

2. **Milestones:**
   - âœ… ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡
   - ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù…
   - â³ Ø¹Ù‚Ø¨â€ŒØ§ÙØªØ§Ø¯Ù‡
   - âŒ Ù„ØºÙˆ Ø´Ø¯Ù‡

3. **Ø¹Ù…Ù„Ú©Ø±Ø¯ KPIs:**
   - Ù…Ù‚Ø§ÛŒØ³Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ vs Ù‡Ø¯Ù
   - Ø±ÙˆÙ†Ø¯ (Ø¨Ù‡Ø¨ÙˆØ¯ / Ø¨Ø¯ØªØ± Ø´Ø¯Ù†)

4. **Ù…ÙˆØ§Ù†Ø¹ Ùˆ Ú†Ø§Ù„Ø´â€ŒÙ‡Ø§:**
   - Ù…Ø³Ø¯ÙˆØ¯Ú©Ù†Ù†Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ
   - Ø¹Ù„Øª ØªØ£Ø®ÛŒØ±Ù‡Ø§

5. **Ø¯Ø³ØªØ§ÙˆØ±Ø¯Ù‡Ø§:**
   - Ù…ÙˆÙÙ‚ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒØ¯ÛŒ
   - ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒâ€ŒÙ‡Ø§

6. **Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª:**
   - Ø¨Ø±Ø§ÛŒ Ø´ØªØ§Ø¨â€ŒØ¨Ø®Ø´ÛŒ
   - Ø¨Ø±Ø§ÛŒ Ø±ÙØ¹ Ù…ÙˆØ§Ù†Ø¹
   - ØªØºÛŒÛŒØ±Ø§Øª Ø¯Ø± Ø§Ø³ØªØ±Ø§ØªÚ˜ÛŒ

7. **Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ:**
   - Ø¢ÛŒØ§ Ø§Ù‡Ø¯Ø§Ù Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªÛŒØ§Ø¨ÛŒ Ù‡Ø³ØªÙ†Ø¯ØŸ
   - Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªØ¹Ø¯ÛŒÙ„ Ø§Ù‡Ø¯Ø§ÙØŸ

ÙØ±Ù…Øª: JSON";

        $response = $this->ask($prompt);
        
        return $this->parseJsonResponse($response);
    }
    
    /**
     * ØªØ¹ÛŒÛŒÙ† Ø§Ù‡Ø¯Ø§Ù SMART
     */
    public function setSmartGoals(string $visionStatement): array
    {
        $prompt = "Ø¨Ø± Ø§Ø³Ø§Ø³ Ú†Ø´Ù…â€ŒØ§Ù†Ø¯Ø§Ø² Ø²ÛŒØ±ØŒ Ø§Ù‡Ø¯Ø§Ù SMART ØªØ¹ÛŒÛŒÙ† Ú©Ù†:

**Ú†Ø´Ù…â€ŒØ§Ù†Ø¯Ø§Ø²:**
{$visionStatement}

Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ù‡Ø¯ÙØŒ Ù…Ø·Ù…Ø¦Ù† Ø´Ùˆ Ú©Ù‡:
- **S**pecific: Ù…Ø´Ø®Øµ Ùˆ ÙˆØ§Ø¶Ø­
- **M**easurable: Ù‚Ø§Ø¨Ù„ Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒ
- **A**chievable: Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªÛŒØ§Ø¨ÛŒ
- **R**elevant: Ù…Ø±ØªØ¨Ø· Ø¨Ø§ Ú†Ø´Ù…â€ŒØ§Ù†Ø¯Ø§Ø²
- **T**ime-bound: Ø¯Ø§Ø±Ø§ÛŒ Ù…Ù‡Ù„Øª Ø²Ù…Ø§Ù†ÛŒ

Ø­Ø¯Ø§Ù‚Ù„ 5 Ù‡Ø¯Ù Ø¯Ø± Ø³Ù‡ Ø¯Ø³ØªÙ‡:
1. Ú©ÙˆØªØ§Ù‡â€ŒÙ…Ø¯Øª (1-3 Ù…Ø§Ù‡)
2. Ù…ÛŒØ§Ù†â€ŒÙ…Ø¯Øª (3-6 Ù…Ø§Ù‡)
3. Ø¨Ù„Ù†Ø¯Ù…Ø¯Øª (6-12 Ù…Ø§Ù‡)

Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ù‡Ø¯Ù:
```json
{
  \"goal\": \"Ø¹Ù†ÙˆØ§Ù† Ù‡Ø¯Ù\",
  \"specific\": \"ØªÙˆØ¶ÛŒØ­ Ø¯Ù‚ÛŒÙ‚\",
  \"measurable\": \"Ù…Ø¹ÛŒØ§Ø± Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒ\",
  \"achievable\": \"Ú†Ø±Ø§ Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªÛŒØ§Ø¨ÛŒ Ø§Ø³Øª\",
  \"relevant\": \"Ú†Ø·ÙˆØ± Ø¨Ù‡ Ú†Ø´Ù…â€ŒØ§Ù†Ø¯Ø§Ø² Ú©Ù…Ú© Ù…ÛŒâ€ŒÚ©Ù†Ø¯\",
  \"timebound\": \"Ù…Ù‡Ù„Øª Ø²Ù…Ø§Ù†ÛŒ\",
  \"kpis\": [\"KPI 1\", \"KPI 2\"],
  \"category\": \"short-term|mid-term|long-term\"
}
```";

        $response = $this->ask($prompt);
        
        return $this->parseJsonResponse($response);
    }
    
    /**
     * Ø¯Ø±ÛŒØ§ÙØª ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡
     */
    protected function getCurrentState(): string
    {
        try {
            $userCount = \App\Models\User::count();
            $auctionCount = \App\Models\Auction::count();
            
            return "
- ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†: {$userCount}
- ØªØ¹Ø¯Ø§Ø¯ Ø­Ø±Ø§Ø¬â€ŒÙ‡Ø§: {$auctionCount}
- ÙØ§Ø² Ù¾Ø±ÙˆÚ˜Ù‡: " . ($userCount < 100 ? 'Ø¢Ù„ÙØ§' : 'Ø¨ØªØ§') . "
- ØªØ§Ø±ÛŒØ® Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ: " . config('app.launch_date', 'ØªØ¹ÛŒÛŒÙ† Ù†Ø´Ø¯Ù‡');
        } catch (\Exception $e) {
            return "ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ Ù‚Ø§Ø¨Ù„ Ø¯Ø³ØªØ±Ø³ÛŒ Ù†ÛŒØ³Øª";
        }
    }
    
    /**
     * Ø¯Ø±ÛŒØ§ÙØª Ù†Ù‚Ø´Ù‡ Ø±Ø§Ù‡ ÙØ¹Ù„ÛŒ
     */
    protected function getCurrentRoadmap(): string
    {
        // Ø¯Ø± Ø¢ÛŒÙ†Ø¯Ù‡ Ø§Ø² Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø¨Ø®ÙˆØ§Ù†ÛŒÙ…
        return "Ù†Ù‚Ø´Ù‡ Ø±Ø§Ù‡ ÙØ¹Ù„ÛŒ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø°Ø®ÛŒØ±Ù‡ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª";
    }
    
    /**
     * Ø¯Ø±ÛŒØ§ÙØª KPIs
     */
    protected function getKPIs(): string
    {
        try {
            return json_encode([
                'total_users' => \App\Models\User::count(),
                'active_users_month' => 'N/A', // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ø± Ø¢ÛŒÙ†Ø¯Ù‡
                'total_auctions' => \App\Models\Auction::count(),
                'active_auctions' => \App\Models\Auction::where('status', 'active')->count(),
            ], JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE);
        } catch (\Exception $e) {
            return '{}';
        }
    }
    
    /**
     * Ù¾Ø§Ø±Ø³ Ú©Ø±Ø¯Ù† Ù¾Ø§Ø³Ø® JSON
     */
    protected function parseJsonResponse(string $response): array
    {
        try {
            $response = preg_replace('/```json\s*(.*?)\s*```/s', '$1', $response);
            $response = preg_replace('/```\s*(.*?)\s*```/s', '$1', $response);
            
            $decoded = json_decode(trim($response), true);
            
            if (json_last_error() === JSON_ERROR_NONE) {
                return $decoded;
            }
            
            return ['raw_response' => $response];
        } catch (\Exception $e) {
            return ['raw_response' => $response, 'error' => $e->getMessage()];
        }
    }
}
