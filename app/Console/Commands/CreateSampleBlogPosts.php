<?php

namespace App\Console\Commands;

use Illuminate\Console\Command;
use App\Modules\Blog\Models\Post;
use App\Modules\Blog\Models\BlogCategory;
use App\Modules\Blog\Models\BlogTag;
use App\Models\User;
use Illuminate\Support\Str;

class CreateSampleBlogPosts extends Command
{
    protected $signature = 'blog:create-samples';
    protected $description = 'Create sample blog posts with full content';

    public function handle()
    {
        $this->info('Creating sample blog posts...');

        // Get or create categories
        $techCategory = BlogCategory::firstOrCreate(
            ['slug' => 'technology'],
            [
                'name' => 'فناوری',
                'description' => 'مقالات مربوط به فناوری و تکنولوژی',
                'status' => 'active',
                'order' => 1
            ]
        );

        $sustainabilityCategory = BlogCategory::firstOrCreate(
            ['slug' => 'sustainability'],
            [
                'name' => 'پایداری',
                'description' => 'مقالات مربوط به پایداری و محیط زیست',
                'status' => 'active',
                'order' => 2
            ]
        );

        $cooperationCategory = BlogCategory::firstOrCreate(
            ['slug' => 'cooperation'],
            [
                'name' => 'همکاری',
                'description' => 'مقالات مربوط به همکاری و تعاون',
                'status' => 'active',
                'order' => 3
            ]
        );

        // Get or create tags
        $tags = [];
        $tagNames = ['زمین', 'محیط زیست', 'تکنولوژی', 'همکاری', 'پایداری', 'آینده', 'جامعه', 'اقتصاد'];
        foreach ($tagNames as $tagName) {
            $tags[] = BlogTag::firstOrCreate(
                ['slug' => Str::slug($tagName)],
                ['name' => $tagName]
            );
        }

        // Get first user as author
        $author = User::first();
        if (!$author) {
            $this->error('No user found. Please create a user first.');
            return 1;
        }

        // Sample posts data
        $posts = [
            [
                'title' => 'آینده پایدار: چگونه تکنولوژی می‌تواند به نجات زمین کمک کند',
                'excerpt' => 'در این مقاله به بررسی نقش تکنولوژی در ایجاد آینده‌ای پایدار و سازگار با محیط زیست می‌پردازیم. از انرژی‌های تجدیدپذیر تا هوش مصنوعی، تکنولوژی‌های نوین چگونه می‌توانند چالش‌های زیست‌محیطی را حل کنند؟',
                'content' => '<h2>مقدمه</h2>
<p>در عصر حاضر، تغییرات اقلیمی و بحران‌های زیست‌محیطی به یکی از بزرگ‌ترین چالش‌های پیش روی بشر تبدیل شده‌اند. اما در کنار این چالش‌ها، تکنولوژی نیز به عنوان ابزاری قدرتمند برای مقابله با این مشکلات ظهور کرده است.</p>

<h2>انرژی‌های تجدیدپذیر</h2>
<p>یکی از مهم‌ترین راه‌حل‌های تکنولوژیک برای کاهش انتشار کربن، استفاده از انرژی‌های تجدیدپذیر است. انرژی خورشیدی، بادی و آبی می‌توانند جایگزین مناسبی برای سوخت‌های فسیلی باشند.</p>

<h3>انرژی خورشیدی</h3>
<p>پنل‌های خورشیدی امروزه به یکی از مقرون‌به‌صرفه‌ترین منابع انرژی تبدیل شده‌اند. با پیشرفت تکنولوژی، هزینه تولید و نصب این پنل‌ها به طور قابل توجهی کاهش یافته است.</p>

<h3>انرژی بادی</h3>
<p>توربین‌های بادی نیز به عنوان یکی از منابع مهم انرژی پاک، نقش مهمی در کاهش وابستگی به سوخت‌های فسیلی ایفا می‌کنند.</p>

<h2>هوش مصنوعی و پایداری</h2>
<p>هوش مصنوعی می‌تواند در بهینه‌سازی مصرف انرژی، مدیریت منابع و پیش‌بینی تغییرات اقلیمی کمک کند. الگوریتم‌های هوش مصنوعی می‌توانند الگوهای مصرف را تحلیل کرده و راه‌حل‌های بهینه ارائه دهند.</p>

<h2>نتیجه‌گیری</h2>
<p>تکنولوژی به تنهایی نمی‌تواند تمام مشکلات زیست‌محیطی را حل کند، اما می‌تواند ابزاری قدرتمند برای حرکت به سمت آینده‌ای پایدار باشد. ترکیب تکنولوژی با تغییرات رفتاری و سیاست‌های مناسب می‌تواند راه را برای نسل‌های آینده هموار کند.</p>',
                'category_id' => $techCategory->id,
                'tags' => [$tags[0], $tags[1], $tags[2], $tags[4]],
                'is_featured' => true,
                'views_count' => 1250,
                'meta_title' => 'آینده پایدار و نقش تکنولوژی',
                'meta_description' => 'بررسی نقش تکنولوژی در ایجاد آینده‌ای پایدار و سازگار با محیط زیست',
                'meta_keywords' => 'تکنولوژی, پایداری, محیط زیست, انرژی تجدیدپذیر'
            ],
            [
                'title' => 'همکاری جهانی برای نجات کره زمین',
                'excerpt' => 'در این مقاله به اهمیت همکاری بین‌المللی برای مقابله با تغییرات اقلیمی و ایجاد آینده‌ای پایدار می‌پردازیم. چگونه می‌توانیم با همکاری یکدیگر، چالش‌های جهانی را حل کنیم؟',
                'content' => '<h2>اهمیت همکاری جهانی</h2>
<p>تغییرات اقلیمی و بحران‌های زیست‌محیطی مرز نمی‌شناسند. برای مقابله با این چالش‌ها، نیاز به همکاری و تعاون بین‌المللی داریم.</p>

<h2>چالش‌های پیش رو</h2>
<p>از افزایش دمای کره زمین تا کاهش تنوع زیستی، چالش‌های پیش روی ما بسیار بزرگ و پیچیده هستند. هیچ کشوری به تنهایی نمی‌تواند این مشکلات را حل کند.</p>

<h3>افزایش دمای کره زمین</h3>
<p>طبق گزارش‌های علمی، دمای کره زمین در حال افزایش است و این افزایش می‌تواند عواقب جدی برای تمام موجودات زنده داشته باشد.</p>

<h3>کاهش تنوع زیستی</h3>
<p>انقراض گونه‌های مختلف گیاهی و جانوری یکی از بزرگ‌ترین تهدیدات برای اکوسیستم کره زمین است.</p>

<h2>راه‌حل‌ها</h2>
<p>برای مقابله با این چالش‌ها، نیاز به اقدامات جمعی و همکاری بین کشورها، سازمان‌ها و افراد داریم.</p>

<h3>توافقنامه‌های بین‌المللی</h3>
<p>توافقنامه‌هایی مانند پاریس می‌توانند چارچوبی برای همکاری بین‌المللی فراهم کنند.</p>

<h3>ابتکارات محلی</h3>
<p>در کنار اقدامات بین‌المللی، ابتکارات محلی نیز نقش مهمی در ایجاد تغییرات مثبت دارند.</p>

<h2>نقش EarthCoop</h2>
<p>EarthCoop به عنوان یک پلتفرم همکاری جهانی، می‌تواند بستری برای همکاری و تعاون بین افراد و جوامع مختلف فراهم کند.</p>

<h2>نتیجه‌گیری</h2>
<p>همکاری و تعاون کلید حل چالش‌های پیش روی ماست. با همکاری یکدیگر می‌توانیم آینده‌ای بهتر برای خود و نسل‌های آینده بسازیم.</p>',
                'category_id' => $cooperationCategory->id,
                'tags' => [$tags[0], $tags[3], $tags[4], $tags[6]],
                'is_featured' => true,
                'views_count' => 980,
                'meta_title' => 'همکاری جهانی برای نجات زمین',
                'meta_description' => 'بررسی اهمیت همکاری بین‌المللی برای مقابله با تغییرات اقلیمی',
                'meta_keywords' => 'همکاری, تعاون, تغییرات اقلیمی, محیط زیست'
            ],
            [
                'title' => 'اقتصاد سبز: راهی به سوی پایداری',
                'excerpt' => 'اقتصاد سبز مفهومی است که به دنبال ایجاد رفاه اقتصادی در کنار حفظ محیط زیست است. در این مقاله به بررسی اصول و مزایای اقتصاد سبز می‌پردازیم.',
                'content' => '<h2>تعریف اقتصاد سبز</h2>
<p>اقتصاد سبز به اقتصادی گفته می‌شود که در آن رشد اقتصادی و رفاه اجتماعی در کنار حفظ محیط زیست و کاهش خطرات زیست‌محیطی حاصل می‌شود.</p>

<h2>اصول اقتصاد سبز</h2>
<p>اقتصاد سبز بر اساس اصول خاصی استوار است که شامل موارد زیر می‌شود:</p>

<h3>کارایی منابع</h3>
<p>استفاده بهینه از منابع طبیعی و کاهش ضایعات یکی از اصول مهم اقتصاد سبز است.</p>

<h3>عدالت اجتماعی</h3>
<p>اقتصاد سبز به دنبال ایجاد فرصت‌های برابر برای همه افراد جامعه است.</p>

<h3>حفاظت از محیط زیست</h3>
<p>حفاظت از محیط زیست و کاهش آلودگی از اهداف اصلی اقتصاد سبز است.</p>

<h2>مزایای اقتصاد سبز</h2>
<p>اقتصاد سبز می‌تواند مزایای متعددی داشته باشد:</p>

<ul>
<li>ایجاد شغل‌های جدید در بخش‌های سبز</li>
<li>کاهش وابستگی به منابع محدود</li>
<li>بهبود کیفیت زندگی</li>
<li>حفاظت از محیط زیست</li>
</ul>

<h2>چالش‌ها</h2>
<p>اگرچه اقتصاد سبز مزایای زیادی دارد، اما با چالش‌هایی نیز روبرو است:</p>

<h3>هزینه‌های اولیه</h3>
<p>تبدیل به اقتصاد سبز نیاز به سرمایه‌گذاری اولیه دارد.</p>

<h3>مقاومت در برابر تغییر</h3>
<p>برخی از بخش‌ها ممکن است در برابر تغییرات مقاومت کنند.</p>

<h2>نتیجه‌گیری</h2>
<p>اقتصاد سبز راهی به سوی آینده‌ای پایدار است. با سرمایه‌گذاری در بخش‌های سبز و تغییر الگوهای مصرف، می‌توانیم به اقتصادی پایدار دست یابیم.</p>',
                'category_id' => $sustainabilityCategory->id,
                'tags' => [$tags[4], $tags[5], $tags[7]],
                'is_featured' => false,
                'views_count' => 750,
                'meta_title' => 'اقتصاد سبز و پایداری',
                'meta_description' => 'بررسی اصول و مزایای اقتصاد سبز برای ایجاد آینده‌ای پایدار',
                'meta_keywords' => 'اقتصاد سبز, پایداری, محیط زیست, توسعه پایدار'
            ],
            [
                'title' => 'نقش جوامع محلی در حفاظت از محیط زیست',
                'excerpt' => 'جوامع محلی نقش مهمی در حفاظت از محیط زیست دارند. در این مقاله به بررسی نقش و اهمیت جوامع محلی در ایجاد تغییرات مثبت می‌پردازیم.',
                'content' => '<h2>اهمیت جوامع محلی</h2>
<p>جوامع محلی به عنوان نزدیک‌ترین واحدهای اجتماعی به محیط زیست، نقش مهمی در حفاظت از آن دارند.</p>

<h2>اقدامات محلی</h2>
<p>جوامع محلی می‌توانند اقدامات مختلفی برای حفاظت از محیط زیست انجام دهند:</p>

<h3>کاهش مصرف</h3>
<p>کاهش مصرف منابع و استفاده بهینه از آنها یکی از اقدامات مهم است.</p>

<h3>بازیافت</h3>
<p>بازیافت مواد و کاهش ضایعات می‌تواند به حفظ محیط زیست کمک کند.</p>

<h3>آموزش</h3>
<p>آموزش و آگاهی‌بخشی به اعضای جامعه در مورد اهمیت حفاظت از محیط زیست بسیار مهم است.</p>

<h2>مثال‌های موفق</h2>
<p>در سراسر جهان، جوامع محلی مختلفی اقدامات موفقیت‌آمیزی برای حفاظت از محیط زیست انجام داده‌اند.</p>

<h2>نقش EarthCoop</h2>
<p>EarthCoop می‌تواند بستری برای ارتباط و همکاری بین جوامع محلی مختلف فراهم کند.</p>

<h2>نتیجه‌گیری</h2>
<p>جوامع محلی می‌توانند با اقدامات کوچک اما مؤثر، نقش مهمی در حفاظت از محیط زیست ایفا کنند.</p>',
                'category_id' => $sustainabilityCategory->id,
                'tags' => [$tags[0], $tags[1], $tags[6]],
                'is_featured' => false,
                'views_count' => 620,
                'meta_title' => 'نقش جوامع محلی در حفاظت از محیط زیست',
                'meta_description' => 'بررسی نقش و اهمیت جوامع محلی در حفاظت از محیط زیست',
                'meta_keywords' => 'جوامع محلی, محیط زیست, حفاظت, پایداری'
            ],
            [
                'title' => 'تکنولوژی‌های نوین در کشاورزی پایدار',
                'excerpt' => 'استفاده از تکنولوژی‌های نوین در کشاورزی می‌تواند به افزایش بهره‌وری و کاهش آسیب به محیط زیست کمک کند. در این مقاله به بررسی این تکنولوژی‌ها می‌پردازیم.',
                'content' => '<h2>کشاورزی پایدار</h2>
<p>کشاورزی پایدار به روشی از کشاورزی گفته می‌شود که در آن از منابع به صورت بهینه استفاده می‌شود و آسیب کمتری به محیط زیست وارد می‌شود.</p>

<h2>تکنولوژی‌های نوین</h2>
<p>تکنولوژی‌های مختلفی می‌توانند به کشاورزی پایدار کمک کنند:</p>

<h3>کشاورزی دقیق</h3>
<p>استفاده از GPS و سنسورها برای مدیریت دقیق‌تر مزارع می‌تواند به کاهش مصرف آب و کود کمک کند.</p>

<h3>کشاورزی عمودی</h3>
<p>کشاورزی عمودی می‌تواند در فضاهای کوچک‌تر محصولات بیشتری تولید کند.</p>

<h3>استفاده از هوش مصنوعی</h3>
<p>هوش مصنوعی می‌تواند در پیش‌بینی بیماری‌های گیاهی و بهینه‌سازی آبیاری کمک کند.</p>

<h2>مزایا</h2>
<p>استفاده از تکنولوژی در کشاورزی می‌تواند مزایای متعددی داشته باشد:</p>

<ul>
<li>افزایش بهره‌وری</li>
<li>کاهش مصرف آب</li>
<li>کاهش استفاده از کود و سموم</li>
<li>کاهش آسیب به محیط زیست</li>
</ul>

<h2>چالش‌ها</h2>
<p>اگرچه تکنولوژی مزایای زیادی دارد، اما با چالش‌هایی نیز روبرو است:</p>

<h3>هزینه</h3>
<p>تکنولوژی‌های نوین ممکن است هزینه‌بر باشند.</p>

<h3>نیاز به آموزش</h3>
<p>کشاورزان نیاز به آموزش برای استفاده از این تکنولوژی‌ها دارند.</p>

<h2>نتیجه‌گیری</h2>
<p>تکنولوژی می‌تواند به کشاورزی پایدار کمک کند، اما نیاز به سرمایه‌گذاری و آموزش دارد.</p>',
                'category_id' => $techCategory->id,
                'tags' => [$tags[2], $tags[4], $tags[0]],
                'is_featured' => false,
                'views_count' => 540,
                'meta_title' => 'تکنولوژی‌های نوین در کشاورزی پایدار',
                'meta_description' => 'بررسی نقش تکنولوژی‌های نوین در کشاورزی پایدار',
                'meta_keywords' => 'کشاورزی, تکنولوژی, پایداری, محیط زیست'
            ]
        ];

        // Create posts
        foreach ($posts as $postData) {
            $tags = $postData['tags'];
            unset($postData['tags']);

            $post = Post::create([
                'title' => $postData['title'],
                'slug' => Str::slug($postData['title']),
                'excerpt' => $postData['excerpt'],
                'content' => $postData['content'],
                'category_id' => $postData['category_id'],
                'user_id' => $author->id,
                'status' => 'published',
                'published_at' => now()->subDays(rand(1, 30)),
                'views_count' => $postData['views_count'],
                'is_featured' => $postData['is_featured'],
                'allow_comments' => true,
                'meta_title' => $postData['meta_title'],
                'meta_description' => $postData['meta_description'],
                'meta_keywords' => $postData['meta_keywords'],
            ]);

            // Attach tags
            $post->tags()->attach(collect($tags)->pluck('id'));

            $this->info("Created post: {$post->title}");
        }

        $this->info('Sample blog posts created successfully!');
        return 0;
    }
}

