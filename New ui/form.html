<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EarthCoop - تکمیل عضویت</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Vazirmatn for Farsi, Poppins for English numbers/text -->
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;500;700;800;900&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Custom Tailwind Configuration - پیکربندی رنگ‌ها و فونت‌ها */
        :root {
            --color-earth-green: #10b981; /* سبز زمینی */
            --color-ocean-blue: #3b82f6; /* آبی اقیانوسی */
            --color-digital-gold: #f59e0b; /* طلایی دیجیتال */
            --color-pure-white: #ffffff; /* سفید خالص */
            --color-light-gray: #f8fafc; /* خاکستری روشن */
            --color-gentle-black: #1e293b; /* مشکی ملایم */
            --color-dark-green: #047857; /* سبز تیره */
            --color-dark-blue: #1d4ed8; /* آبی تیره */
            --color-accent-peach: #ff7e5f; /* هلویی تاکیدی */
            --color-accent-sky: #6dd5ed; /* آبی آسمانی تاکیدی */
            --color-purple-700: #6B46C1; /* بنفش تیره برای هاور */
            --color-vibrant-yellow: #FFD700; /* زرد پر جنب و جوش */
            --color-vibrant-pink: #FF69B4; /* صورتی پر جنب و جوش */
            --color-vibrant-orange: #FFA500; /* نارنجی پر جنب و جوش */
        }

        /* Utility classes for custom colors */
        .bg-earth-green { background-color: var(--color-earth-green); }
        .text-earth-green { color: var(--color-earth-green); }
        .bg-ocean-blue { background-color: var(--color-ocean-blue); }
        .text-ocean-blue { color: var(--color-ocean-blue); }
        .bg-digital-gold { background-color: var(--color-digital-gold); }
        .text-digital-gold { color: var(--color-digital-gold); }
        .bg-pure-white { background-color: var(--color-pure-white); }
        .text-pure-white { color: var(--color-pure-white); }
        .bg-light-gray { background-color: var(--color-light-gray); }
        .text-light-gray { color: var(--color-light-gray); }
        .bg-gentle-black { background-color: var(--color-gentle-black); }
        .text-gentle-black { color: var(--color-gentle-black); }
        .bg-dark-green { background-color: var(--color-dark-green); }
        .bg-dark-blue { background-color: var(--color-dark-blue); }
        .bg-accent-peach { background-color: var(--color-accent-peach); }
        .text-accent-peach { color: var(--color-accent-peach); }
        .bg-accent-sky { background-color: var(--color-accent-sky); }
        .text-accent-sky { color: var(--color-accent-sky); }
        .text-purple-700 { color: var(--color-purple-700); }

        /* Font Families - Vazirmatn for Farsi, Poppins for English numbers/text */
        .font-vazirmatn { font-family: 'Vazirmatn', sans-serif; }
        .font-poppins { font-family: 'Poppins', sans-serif; }

        /* Custom animation for the logo */
        @keyframes bounce-custom {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        .animate-bounce-custom { animation: bounce-custom 3s infinite ease-in-out; }

        /* Gradient background for the signup card */
        .form-card-gradient {
            background: linear-gradient(145deg, var(--color-pure-white) 0%, #f0f4f7 100%);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.08);
            transition: all 0.4s ease;
            border-radius: 18px;
            overflow: hidden;
            position: relative;
            border: 1px solid rgba(220, 220, 220, 0.3);
        }
        .form-card-gradient::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, var(--color-earth-green), var(--color-ocean-blue), var(--color-digital-gold));
        }

        /* Vibrant background for the body */
        /* پس‌زمینه برای بدنه (تغییر یافته به طوسی) */
        body {
            background-color: #e2e8f0; /* رنگ طوسی روشن */
            background-attachment: fixed;
        }

        /* Custom modal for messages */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1000; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 500px; /* Increased max-width for welcome message */
            border-radius: 10px;
            text-align: center;
            position: relative;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .close-button {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            position: absolute;
            top: 10px;
            right: 15px;
            cursor: pointer;
        }

        .close-button:hover,
        .close-button:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }

        /* Styling for the custom input modal */
        .custom-input-modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1001; /* Sit on top of other modals */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.6); /* Darker background */
            justify-content: center;
            align-items: center;
        }

        .custom-input-modal-content {
            background-color: #fefefe;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            position: relative;
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            width: 90%;
            max-width: 400px;
        }
    </style>
</head>
<body class="font-poppins text-gentle-black leading-relaxed flex items-center justify-center min-h-screen p-4">

    <!-- Welcome Modal -->
    <div id="welcome-modal" class="modal flex">
        <div class="modal-content">
            <p id="welcome-message" class="font-vazirmatn text-gentle-black text-lg mb-6 leading-relaxed">
                سهامدار عزیز، تبریک! شما با موفقیت به EarthCoop پیوستید. دنیای همکاری
                های بزرگ در انتظار شماست. لطفا دقایقی وقت بگذارید و در سه مرحله اطلاعات
                هویتی، اطلاعات صنفی و تخصصی، و اطلاعات مکانی خود را وارد و عضویت خود را
                فعال نمایید.
            </p>
            <button id="ok-button" class="mt-4 bg-ocean-blue text-pure-white px-8 py-3 rounded-full hover:bg-dark-blue transition duration-300 font-vazirmatn font-bold text-lg">
                باشه
            </button>
        </div>
    </div>

    <!-- Main Form Content -->
    <div id="main-form-content" class="form-card-gradient w-full max-w-2xl mx-auto p-8 md:p-10 text-center hidden">
        <div class="flex items-center justify-center space-x-3 rtl:space-x-reverse mb-8">
            <!-- EarthCoop Logo -->
            <svg width="60" height="60" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="animate-bounce-custom">
                <path d="M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2Z" fill="#10b981" opacity="0.8"/>
                <path d="M12 2C10.5 4 8 6 8 9C8 12 12 14 12 14C12 14 16 12 16 9C16 6 13.5 4 12 2ZM12 14C12 14 10 16 10 18C10 20 12 22 12 22" fill="#047857"/>
            </svg>
            <span class="text-4xl font-extrabold text-gentle-black font-vazirmatn">EarthCoop</span>
        </div>

        <!-- Step 1: Identity Information -->
        <div id="identity-form-section" class="text-right hidden">
            <h2 class="text-3xl md:text-4xl font-extrabold font-vazirmatn text-gentle-black mb-6">
                مرحله ۱: اطلاعات هویتی
            </h2>
            <form id="identity-form" class="space-y-6">
                <!-- Name -->
                <div>
                    <label for="first-name" class="block text-lg font-bold text-gray-800 font-vazirmatn mb-3">
                        نام:
                    </label>
                    <input type="text" id="first-name" name="first-name" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-base font-vazirmatn text-gentle-black"
                           placeholder="نام خود را وارد کنید">
                </div>
                <!-- Last Name -->
                <div>
                    <label for="last-name" class="block text-lg font-bold text-gray-800 font-vazirmatn mb-3">
                        نام خانوادگی:
                    </label>
                    <input type="text" id="last-name" name="last-name" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-base font-vazirmatn text-gentle-black"
                           placeholder="نام خانوادگی خود را وارد کنید">
                </div>
                <!-- Date of Birth -->
                <div>
                    <label for="dob" class="block text-lg font-bold text-gray-800 font-vazirmatn mb-3">
                        تاریخ تولد:
                    </label>
                    <input type="date" id="dob" name="dob" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-base font-vazirmatn text-gentle-black">
                </div>
                <!-- Gender -->
                <div>
                    <label class="block text-lg font-bold text-gray-800 font-vazirmatn mb-3">
                        جنسیت:
                    </label>
                    <div class="flex flex-wrap gap-4">
                        <label class="inline-flex items-center">
                            <input type="radio" name="gender" value="male" class="form-radio text-earth-green h-5 w-5">
                            <span class="ml-2 font-vazirmatn text-gray-700">مرد</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="radio" name="gender" value="female" class="form-radio text-earth-green h-5 w-5">
                            <span class="ml-2 font-vazirmatn text-gray-700">زن</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="radio" name="gender" value="other" class="form-radio text-earth-green h-5 w-5">
                            <span class="ml-2 font-vazirmatn text-gray-700">دیگر</span>
                        </label>
                    </div>
                </div>
                <!-- Nationality -->
                <div>
                    <label for="nationality" class="block text-lg font-bold text-gray-800 font-vazirmatn mb-3">
                        ملیت:
                    </label>
                    <input type="text" id="nationality" name="nationality" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-base font-vazirmatn text-gentle-black"
                           placeholder="ملیت خود را وارد کنید">
                </div>
                <!-- National ID -->
                <div>
                    <label for="national-id" class="block text-lg font-bold text-gray-800 font-vazirmatn mb-3">
                        کدملی:
                    </label>
                    <input type="text" id="national-id" name="national-id" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-base font-vazirmatn text-gentle-black"
                           placeholder="کدملی خود را وارد کنید">
                </div>
                <!-- Phone Number -->
                <div>
                    <label for="phone-number" class="block text-lg font-bold text-gray-800 font-vazirmatn mb-3">
                        شماره تلفن:
                    </label>
                    <input type="tel" id="phone-number" name="phone-number" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-base font-poppins text-gentle-black text-right"
                           placeholder="مثال: 09123456789">
                </div>

                <button type="submit" id="continue-step1-button"
                        class="w-full bg-earth-green text-pure-white px-6 py-3 rounded-full shadow-md hover:bg-dark-green transition duration-300 font-vazirmatn font-bold text-lg transform hover:scale-105 mt-10">
                    ادامه
                </button>
            </form>
        </div>

        <!-- Step 2: Professional and Specialized Information (current content, initially hidden) -->
        <div id="professional-form-section" class="text-right hidden">
            <h2 class="text-3xl md:text-4xl font-extrabold font-vazirmatn text-gentle-black mb-6">
                مرحله دوم: انتخاب زمینه‌های صنفی و تخصصی
            </h2>
            <p class="text-gray-700 mb-8 font-vazirmatn">
                لطفا زمینه‌های صنفی و تخصصی خود را وارد نمایید، از این اطلاعات برای ایجاد گروه‌های صنفی و تخصصی شما استفاده می‌شود.
            </p>
            <form id="profile-form" class="space-y-8 text-right">
                <!-- Professional Activity Field -->
                <div>
                    <label for="professional-field-select" class="block text-lg font-bold text-gray-800 font-vazirmatn mb-3">
                        زمینه فعالیت صنفی:
                    </label>
                    <div class="flex items-center space-x-4 rtl:space-x-reverse">
                        <select id="professional-field-select"
                                class="flex-grow px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-base font-vazirmatn text-gentle-black">
                            <option value="">انتخاب کنید</option>
                            <option value="صنف معلمان و مربیان">صنف معلمان و مربیان</option>
                            <option value="صنف مدیران و مسئولان آموزشی">صنف مدیران و مسئولان آموزشی</option>
                            <option value="صنف کشاورزان و دامداران">صنف کشاورزان و دامداران</option>
                            <option value="صنف صنعتگران">صنف صنعتگران</option>
                            <option value="صنف کارگران و تکنسین ها">صنف کارگران و تکنسین ها</option>
                            <option value="صنف کارمندان و اداری ها">صنف کارمندان و اداری ها</option>
                            <option value="صنف پزشکان، پرستاران و سلامت یاران">صنف پزشکان، پرستاران و سلامت یاران</option>
                            <option value="صنف هنرمندان، نویسندگان و اهل رسانه">صنف هنرمندان، نویسندگان و اهل رسانه</option>
                            <option value="صنف بازرگانان، فروشندگان و تاجران">صنف بازرگانان، فروشندگان و تاجران</option>
                            <option value="صنف کارآفرینان، صاحبان کسب و کار و استارت آپ ها">صنف کارآفرینان، صاحبان کسب و کار و استارت آپ ها</option>
                            <option value="صنف نظامیان، نیروهای امنیتی و انتظامی">صنف نظامیان، نیروهای امنیتی و انتظامی</option>
                            <option value="صنف بازنشستگان و پیشکسوتان">صنف بازنشستگان و پیشکسوتان</option>
                            <option value="صنف مدیران و کارکنان نهادهای عمومی و غیر دولتی">صنف مدیران و کارکنان نهادهای عمومی و غیر دولتی</option>
                            <option value="صنف دانش آموزان، دانشجویان و طلاب">صنف دانش آموزان، دانشجویان و طلاب</option>
                            <option value="صنف کارکنان ادارات، شرکتها و بانکها">صنف کارکنان ادارات، شرکتها و بانکها</option>
                            <option value="صنف بیکاران، جویندگان کار، مهاجران و اقشار در حال گذار">صنف بیکاران، جویندگان کار، مهاجران و اقشار در حال گذار</option>
                            <option value="صنف توان یابان (افراد دارای معلولیت)">صنف توان یابان (افراد دارای معلولیت)</option>
                            <option value="صنف خانواده داران، خانه داران و پرستاران خانگی">صنف خانواده داران، خانه داران و پرستاران خانگی</option>
                            <option value="صنف نخبگان، مخترعان، کارآفرینان، اندیشمندان و آینده پژوهان">صنف نخبگان، مخترعان، کارآفرینان، اندیشمندان و آینده پژوهان</option>
                            <option value="صنف روحانیان ادیان و مبلغان مذهبی">صنف روحانیان ادیان و مبلغان مذهبی</option>
                        </select>
                        <button type="button" id="add-professional-field-button"
                                class="bg-earth-green text-pure-white px-5 py-2 rounded-full shadow-md hover:bg-dark-green transition duration-300 font-vazirmatn text-base">
                            +ایجاد کنید
                        </button>
                    </div>
                    <div id="professional-subcategory-section" class="mt-4 hidden">
                        <label for="professional-subcategory-input" class="block text-sm font-medium text-gray-700 font-vazirmatn mb-2">
                            در صورت نیاز زیردسته صنف خود را وارد کنید:
                        </label>
                        <div class="flex items-center space-x-4 rtl:space-x-reverse">
                            <input type="text" id="professional-subcategory-input"
                                   class="flex-grow px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-sm font-vazirmatn text-gentle-black"
                                   placeholder="زیردسته صنف">
                            <button type="button" id="save-professional-subcategory-button"
                                    class="bg-ocean-blue text-pure-white px-5 py-2 rounded-full shadow-md hover:bg-dark-blue transition duration-300 font-vazirmatn text-base">
                                ثبت
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Temporary Modal for adding new professional field -->
                <div id="professional-field-modal" class="custom-input-modal">
                    <div class="custom-input-modal-content">
                        <span class="close-button" id="close-professional-modal">&times;</span>
                        <h3 class="text-xl font-bold font-vazirmatn mb-4">نام زمینه فعالیت</h3>
                        <input type="text" id="new-professional-field-input"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-base font-vazirmatn text-gentle-black mb-4"
                               placeholder="نام زمینه فعالیت جدید">
                        <button type="button" id="save-professional-field-button"
                                class="bg-earth-green text-pure-white px-6 py-3 rounded-full shadow-md hover:bg-dark-green transition duration-300 font-vazirmatn font-bold text-lg">
                            ثبت
                        </button>
                    </div>
                </div>

                <!-- Experiential and Specialized Field -->
                <div>
                    <label for="specialized-field-select" class="block text-lg font-bold text-gray-800 font-vazirmatn mb-3">
                        زمینه تجربی و تخصصی:
                    </label>
                    <div class="flex items-center space-x-4 rtl:space-x-reverse">
                        <select id="specialized-field-select"
                                class="flex-grow px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-base font-vazirmatn text-gentle-black">
                            <option value="">انتخاب کنید</option>
                            <option value="علوم پایه">علوم پایه</option>
                            <option value="علوم مهندسی">علوم مهندسی</option>
                            <option value="علوم انسانی و اجتماعی">علوم انسانی و اجتماعی</option>
                            <option value="علوم پزشکی و سلامت">علوم پزشکی و سلامت</option>
                            <option value="علوم کشاورزی">علوم کشاورزی</option>
                            <option value="هنر و معماری">هنر و معماری</option>
                        </select>
                        <button type="button" id="add-specialized-field-button"
                                class="bg-earth-green text-pure-white px-5 py-2 rounded-full shadow-md hover:bg-dark-green transition duration-300 font-vazirmatn text-base">
                            +ایجاد کنید
                        </button>
                    </div>
                    <div id="specialized-subcategory-section" class="mt-4 hidden">
                        <label for="specialized-subcategory-input" class="block text-sm font-medium text-gray-700 font-vazirmatn mb-2">
                            در صورت نیاز زیردسته تجربی و تخصصی خود را وارد کنید:
                        </label>
                        <div class="flex items-center space-x-4 rtl:space-x-reverse">
                            <input type="text" id="specialized-subcategory-input"
                                   class="flex-grow px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-sm font-vazirmatn text-gentle-black"
                                   placeholder="زیردسته تجربی و تخصصی">
                            <button type="button" id="save-specialized-subcategory-button"
                                    class="bg-ocean-blue text-pure-white px-5 py-2 rounded-full shadow-md hover:bg-dark-blue transition duration-300 font-vazirmatn text-base">
                                ثبت
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Temporary Modal for adding new specialized field -->
                <div id="specialized-field-modal" class="custom-input-modal">
                    <div class="custom-input-modal-content">
                        <span class="close-button" id="close-specialized-modal">&times;</span>
                        <h3 class="text-xl font-bold font-vazirmatn mb-4">ایجاد زمینه تجربی و تخصصی</h3>
                        <input type="text" id="new-specialized-field-input"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-base font-vazirmatn text-gentle-black mb-4"
                               placeholder="نام زمینه تجربی و تخصصی جدید">
                        <button type="button" id="save-specialized-field-button"
                                class="bg-earth-green text-pure-white px-6 py-3 rounded-full shadow-md hover:bg-dark-green transition duration-300 font-vazirmatn font-bold text-lg">
                            ثبت
                        </button>
                    </div>
                </div>

                <!-- Continue Button -->
                <button type="submit" id="continue-form-button"
                        class="w-full bg-earth-green text-pure-white px-6 py-3 rounded-full shadow-md hover:bg-dark-green transition duration-300 font-vazirmatn font-bold text-lg transform hover:scale-105 mt-10">
                    ادامه
                </button>
            </form>
        </div>

        <!-- Step 3: Location Information -->
        <div id="location-form-section" class="text-right hidden">
            <h2 class="text-3xl md:text-4xl font-extrabold font-vazirmatn text-gentle-black mb-6">
                مرحله سوم: انتخاب مکان
            </h2>
            <p class="text-gray-700 mb-8 font-vazirmatn">
                لطفاً مکان خود را با دقت انتخاب نمایید. از این اطلاعات برای گروه‌بندی مکانی شما استفاده می‌شود.
                وارد کردن اطلاعات تا سطح محله الزامی است.
            </p>
            <form id="location-form" class="space-y-6">
                <!-- Continent -->
                <div>
                    <label for="continent-select" class="block text-lg font-bold text-gray-800 font-vazirmatn mb-3">
                        قاره:
                    </label>
                    <select id="continent-select" name="continent" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-base font-vazirmatn text-gentle-black">
                        <option value="">انتخاب کنید</option>
                    </select>
                </div>
                <!-- Country -->
                <div>
                    <label for="country-select" class="block text-lg font-bold text-gray-800 font-vazirmatn mb-3">
                        کشور:
                    </label>
                    <select id="country-select" name="country" required disabled
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-base font-vazirmatn text-gentle-black">
                        <option value="">انتخاب کنید</option>
                    </select>
                </div>
                <!-- City -->
                <div>
                    <label for="city-select" class="block text-lg font-bold text-gray-800 font-vazirmatn mb-3">
                        شهر:
                    </label>
                    <select id="city-select" name="city" required disabled
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-base font-vazirmatn text-gentle-black">
                        <option value="">انتخاب کنید</option>
                    </select>
                </div>
                <!-- Postal Address -->
                <div>
                    <label for="postal-address" class="block text-lg font-bold text-gray-800 font-vazirmatn mb-3">
                        آدرس پستی:
                    </label>
                    <input type="text" id="postal-address" name="postal-address" required
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-ocean-blue focus:border-ocean-blue sm:text-base font-vazirmatn text-gentle-black"
                           placeholder="آدرس پستی خود را وارد کنید (خیابان، کوچه، پلاک، محله)">
                </div>

                <button type="submit" id="continue-step3-button"
                        class="w-full bg-earth-green text-pure-white px-6 py-3 rounded-full shadow-md hover:bg-dark-green transition duration-300 font-vazirmatn font-bold text-lg transform hover:scale-105 mt-10">
                    ادامه
                </button>
            </form>
        </div>
    </div>

    <!-- Final Welcome Modal -->
    <div id="final-welcome-modal" class="modal">
        <div class="modal-content">
            <p id="final-welcome-message" class="font-vazirmatn text-gentle-black text-lg mb-6 leading-relaxed">
                به جامعه ارث کوپ خوش آمدید!
            </p>
            <button id="enter-dashboard-button" class="mt-4 bg-ocean-blue text-pure-white px-8 py-3 rounded-full hover:bg-dark-blue transition duration-300 font-vazirmatn font-bold text-lg">
                ورود به کابین شخصی
            </button>
        </div>
    </div>

    <script type="module">
        // Get elements
        const welcomeModal = document.getElementById('welcome-modal');
        const okButton = document.getElementById('ok-button');
        const mainFormContent = document.getElementById('main-form-content');

        // Step 1: Identity Form elements
        const identityFormSection = document.getElementById('identity-form-section');
        const identityForm = document.getElementById('identity-form');

        // Step 2: Professional Field elements
        const professionalFormSection = document.getElementById('professional-form-section');
        const professionalFieldSelect = document.getElementById('professional-field-select');
        const addProfessionalFieldButton = document.getElementById('add-professional-field-button');
        const professionalFieldModal = document.getElementById('professional-field-modal');
        const closeProfessionalModal = document.getElementById('close-professional-modal');
        const newProfessionalFieldInput = document.getElementById('new-professional-field-input');
        const saveProfessionalFieldButton = document.getElementById('save-professional-field-button');
        const professionalSubcategorySection = document.getElementById('professional-subcategory-section');
        const professionalSubcategoryInput = document.getElementById('professional-subcategory-input');
        const saveProfessionalSubcategoryButton = document.getElementById('save-professional-subcategory-button');

        // Specialized Field elements
        const specializedFieldSelect = document.getElementById('specialized-field-select');
        const addSpecializedFieldButton = document.getElementById('add-specialized-field-button');
        const specializedFieldModal = document.getElementById('specialized-field-modal');
        const closeSpecializedModal = document.getElementById('close-specialized-modal');
        const newSpecializedFieldInput = document.getElementById('new-specialized-field-input');
        const saveSpecializedFieldButton = document.getElementById('save-specialized-field-button');
        const specializedSubcategorySection = document.getElementById('specialized-subcategory-section');
        const specializedSubcategoryInput = document.getElementById('specialized-subcategory-input');
        const saveSpecializedSubcategoryButton = document.getElementById('save-specialized-subcategory-button');

        // Step 3: Location Form elements
        const locationFormSection = document.getElementById('location-form-section');
        const locationForm = document.getElementById('location-form');
        const continentSelect = document.getElementById('continent-select');
        const countrySelect = document.getElementById('country-select');
        const citySelect = document.getElementById('city-select');
        const postalAddressInput = document.getElementById('postal-address');
        const continueStep3Button = document.getElementById('continue-step3-button');

        // Final Welcome Modal elements
        const finalWelcomeModal = document.getElementById('final-welcome-modal');
        const enterDashboardButton = document.getElementById('enter-dashboard-button');

        // Sample Location Data
        const locationData = {
            "آسیا": {
                "ایران": ["تهران", "مشهد", "اصفهان", "شیراز", "تبریز"],
                "ژاپن": ["توکیو", "کیوتو", "اوزاکا"],
                "هند": ["دهلی نو", "بمبئی", "بنگلور"]
            },
            "اروپا": {
                "اسپانیا": ["مادرید", "بارسلونا", "والنسیا", "سویا"],
                "آلمان": ["برلین", "مونیخ", "هامبورگ"],
                "فرانسه": ["پاریس", "مارسی", "لیون"]
            },
            "آمریکای شمالی": {
                "ایالات متحده": ["نیویورک", "لس آنجلس", "شیکاگو"],
                "کانادا": ["تورنتو", "ونکوور", "مونترال"]
            }
        };

        // Function to display custom alert modal (replaces native alert)
        function showAlert(message) {
            const modal = document.getElementById('message-modal'); // Assuming you have this modal from signup.html
            const modalMessage = document.getElementById('modal-message');
            const modalOkBtn = document.getElementById('modal-ok-button');
            const closeBtn = modal.querySelector('.close-button');

            modalMessage.textContent = message;
            modal.style.display = 'flex';

            const closeHandler = () => {
                modal.style.display = 'none';
                modalOkBtn.removeEventListener('click', closeHandler);
                closeBtn.removeEventListener('click', closeHandler);
                window.removeEventListener('click', outsideClickHandler);
            };

            const outsideClickHandler = (event) => {
                if (event.target === modal) {
                    closeHandler();
                }
            };

            modalOkBtn.addEventListener('click', closeHandler);
            closeBtn.addEventListener('click', closeHandler);
            window.addEventListener('click', outsideClickHandler);
        }

        // Show welcome modal on page load
        window.onload = function() {
            welcomeModal.style.display = 'flex';
            populateContinents(); // Populate continents when page loads
        };

        // Handle "باشه" button click in welcome modal
        okButton.addEventListener('click', () => {
            welcomeModal.style.display = 'none';
            mainFormContent.classList.remove('hidden'); // Show the main form content wrapper
            identityFormSection.classList.remove('hidden'); // Show Step 1 form
        });

        // Handle "ادامه" button click in Step 1 (Identity Form)
        identityForm.addEventListener('submit', (e) => {
            e.preventDefault();
            // Basic validation for Step 1 fields (add more as needed)
            const firstName = document.getElementById('first-name').value.trim();
            const lastName = document.getElementById('last-name').value.trim();
            const dob = document.getElementById('dob').value.trim();
            const gender = document.querySelector('input[name="gender"]:checked');
            const nationality = document.getElementById('nationality').value.trim();
            const nationalId = document.getElementById('national-id').value.trim();
            const phoneNumber = document.getElementById('phone-number').value.trim();

            if (!firstName || !lastName || !dob || !gender || !nationality || !nationalId || !phoneNumber) {
                showAlert("لطفا تمام فیلدهای اطلاعات هویتی را پر کنید.");
                return;
            }

            console.log("Identity Form Submitted!");
            // You would typically save this data here
            identityFormSection.classList.add('hidden'); // Hide Step 1
            professionalFormSection.classList.remove('hidden'); // Show Step 2
        });

        // Event listener for professional field selection change
        professionalFieldSelect.addEventListener('change', () => {
            if (professionalFieldSelect.value !== "") {
                professionalSubcategorySection.classList.remove('hidden');
            } else {
                professionalSubcategorySection.classList.add('hidden');
            }
        });

        // Event listener for adding new professional field
        addProfessionalFieldButton.addEventListener('click', () => {
            professionalFieldModal.style.display = 'flex';
            newProfessionalFieldInput.value = ''; // Clear input field
        });

        // Close professional field modal
        closeProfessionalModal.addEventListener('click', () => {
            professionalFieldModal.style.display = 'none';
        });

        // Save new professional field
        saveProfessionalFieldButton.addEventListener('click', () => {
            const newField = newProfessionalFieldInput.value.trim();
            if (newField) {
                const option = document.createElement('option');
                option.value = newField;
                option.textContent = newField;
                professionalFieldSelect.appendChild(option);
                professionalFieldSelect.value = newField; // Select the newly added option
                professionalFieldModal.style.display = 'none';
                professionalSubcategorySection.classList.remove('hidden'); // Show subcategory section
            } else {
                showAlert("لطفا نام زمینه فعالیت را وارد کنید.");
            }
        });

        // Save professional subcategory
        saveProfessionalSubcategoryButton.addEventListener('click', () => {
            const subcategory = professionalSubcategoryInput.value.trim();
            if (subcategory) {
                console.log("Professional Subcategory Saved:", subcategory);
                // Here you would typically save this data to a backend or state
                showAlert(`زیردسته صنفی "${subcategory}" ثبت شد.`);
                professionalSubcategoryInput.value = ''; // Clear the input
            } else {
                showAlert("لطفا زیردسته صنف را وارد کنید.");
            }
        });

        // Event listener for specialized field selection change
        specializedFieldSelect.addEventListener('change', () => {
            if (specializedFieldSelect.value !== "") {
                specializedSubcategorySection.classList.remove('hidden');
            } else {
                specializedSubcategorySection.classList.add('hidden');
            }
        });

        // Event listener for adding new specialized field
        addSpecializedFieldButton.addEventListener('click', () => {
            specializedFieldModal.style.display = 'flex';
            newSpecializedFieldInput.value = ''; // Clear input field
        });

        // Close specialized field modal
        closeSpecializedModal.addEventListener('click', () => {
            specializedFieldModal.style.display = 'none';
        });

        // Save new specialized field
        saveSpecializedFieldButton.addEventListener('click', () => {
            const newField = newSpecializedFieldInput.value.trim();
            if (newField) {
                const option = document.createElement('option');
                option.value = newField;
                option.textContent = newField;
                specializedFieldSelect.appendChild(option);
                specializedFieldSelect.value = newField; // Select the newly added option
                specializedFieldModal.style.display = 'none';
                specializedSubcategorySection.classList.remove('hidden'); // Show subcategory section
            } else {
                showAlert("لطفا نام زمینه تجربی و تخصصی را وارد کنید.");
            }
        });

        // Save specialized subcategory
        saveSpecializedSubcategoryButton.addEventListener('click', () => {
            const subcategory = specializedSubcategoryInput.value.trim();
            if (subcategory) {
                console.log("Specialized Subcategory Saved:", subcategory);
                // Here you would typically save this data to a backend or state
                showAlert(`زیردسته تجربی و تخصصی "${subcategory}" ثبت شد.`);
                specializedSubcategoryInput.value = ''; // Clear the input
            } else {
                showAlert("لطفا زیردسته تجربی و تخصصی را وارد کنید.");
            }
        });

        // Handle form submission (for the "ادامه" button at the bottom of Step 2)
        document.getElementById('profile-form').addEventListener('submit', (e) => {
            e.preventDefault();
            // Here you would collect all the selected/entered data for Step 2
            const professionalSelected = professionalFieldSelect.value;
            const professionalSub = professionalSubcategoryInput.value.trim();
            const specializedSelected = specializedFieldSelect.value;
            const specializedSub = specializedSubcategoryInput.value.trim();

            if (!professionalSelected) {
                showAlert("لطفا زمینه فعالیت صنفی را انتخاب کنید.");
                return;
            }
            if (!specializedSelected) {
                showAlert("لطفا زمینه تجربی و تخصصی را انتخاب کنید.");
                return;
            }

            console.log("Professional Form Submitted!");
            // You would typically save this data here
            professionalFormSection.classList.add('hidden'); // Hide Step 2
            locationFormSection.classList.remove('hidden'); // Show Step 3
        });

        // Location Form Logic (Step 3)

        // Populate Continent dropdown
        function populateContinents() {
            continentSelect.innerHTML = '<option value="">انتخاب کنید</option>'; // Clear existing options
            for (const continent in locationData) {
                const option = document.createElement('option');
                option.value = continent;
                option.textContent = continent;
                continentSelect.appendChild(option);
            }
        }

        // Populate Country dropdown based on selected Continent
        continentSelect.addEventListener('change', () => {
            countrySelect.innerHTML = '<option value="">انتخاب کنید</option>';
            citySelect.innerHTML = '<option value="">انتخاب کنید</option>';
            countrySelect.disabled = true;
            citySelect.disabled = true;

            const selectedContinent = continentSelect.value;
            if (selectedContinent && locationData[selectedContinent]) {
                for (const country in locationData[selectedContinent]) {
                    const option = document.createElement('option');
                    option.value = country;
                    option.textContent = country;
                    countrySelect.appendChild(option);
                }
                countrySelect.disabled = false;
            }
        });

        // Populate City dropdown based on selected Country
        countrySelect.addEventListener('change', () => {
            citySelect.innerHTML = '<option value="">انتخاب کنید</option>';
            citySelect.disabled = true;

            const selectedContinent = continentSelect.value;
            const selectedCountry = countrySelect.value;
            if (selectedContinent && selectedCountry && locationData[selectedContinent] && locationData[selectedContinent][selectedCountry]) {
                locationData[selectedContinent][selectedCountry].forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.textContent = city;
                    citySelect.appendChild(option);
                });
                citySelect.disabled = false;
            }
        });

        // Handle "ادامه" button click in Step 3 (Location Form)
        locationForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const selectedContinent = continentSelect.value;
            const selectedCountry = countrySelect.value;
            const selectedCity = citySelect.value;
            const postalAddress = postalAddressInput.value.trim();

            if (!selectedContinent || !selectedCountry || !selectedCity || !postalAddress) {
                showAlert("لطفا تمام فیلدهای مکان را پر کنید. وارد کردن اطلاعات تا سطح محله الزامی است.");
                return;
            }

            console.log("Location Form Submitted!");
            console.log("Continent:", selectedContinent);
            console.log("Country:", selectedCountry);
            console.log("City:", selectedCity);
            console.log("Postal Address:", postalAddress);

            // You would typically save this data here

            // Show final welcome modal
            finalWelcomeModal.style.display = 'flex';
        });

        // Handle "ورود به کابین شخصی" button click in final welcome modal
        enterDashboardButton.addEventListener('click', () => {
            window.location.href = 'index1.html'; // Redirect to dashboard
        });
    </script>
</body>
</html>
